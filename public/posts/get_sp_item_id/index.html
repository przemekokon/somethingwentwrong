<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=61585&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to Get SharePoint Item ID Using Microsoft Graph API | SomethingWentWrong.dev</title><meta name=keywords content="powershell,microsoft-graph,sharepoint"><meta name=description content="Introduction
When working with Microsoft Graph API to automate SharePoint operations (like writing script outputs, saving reports, updating Excel files), we can&rsquo;t just use file paths. We need to work with unique identifiers - specifically - the file ID.
This guide walks you through the process of finding a SharePoint item ID by navigating the site hierarchy using Graph API Explorer.
The Goal
In this example, we&rsquo;ll find the ID of an Excel file located deep within a SharePoint site structure:"><meta name=author content="Przemek"><link rel=canonical href=http://localhost:61585/posts/get_sp_item_id/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=http://localhost:61585/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:61585/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:61585/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:61585/apple-touch-icon.png><link rel=mask-icon href=http://localhost:61585/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:61585/posts/get_sp_item_id/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><style>.no-light-modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#0a0a0a;border:2px solid #404040;padding:2rem;border-radius:8px;z-index:9999;box-shadow:0 0 80px rgba(0,0,0,.9);max-width:400px;text-align:center}.no-light-modal.show{display:block;animation:modalFadeIn .3s ease}@keyframes modalFadeIn{from{opacity:0;transform:translate(-50%,-45%)}to{opacity:1;transform:translate(-50%,-50%)}}.no-light-modal p{color:#b0b0b0;margin:1rem 0;line-height:1.6;font-size:1.1rem}.no-light-modal p.subtitle{color:#666;font-size:.9em;font-style:italic}.no-light-modal button{background:#1a1a1a;border:1px solid #404040;padding:.75rem 2rem;border-radius:4px;cursor:pointer;color:#888;font-weight:400;font-size:1rem;margin-top:1rem;transition:all .2s ease}.no-light-modal button:hover{background:#252525;border-color:#555;color:#aaa}.modal-backdrop{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:9998}.modal-backdrop.show{display:block;animation:backdropFadeIn .3s ease}@keyframes backdropFadeIn{from{opacity:0}to{opacity:1}}</style><div class=modal-backdrop id=modal-backdrop onclick=closeNoLightModal()></div><div class=no-light-modal id=no-light-modal><p>There is no light out here.</p><p class=subtitle>Dark mode is the only mode.</p><button onclick=closeNoLightModal()>Accept</button></div><script>function closeNoLightModal(){document.getElementById("no-light-modal").classList.remove("show"),document.getElementById("modal-backdrop").classList.remove("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("theme-toggle")||document.querySelector('[aria-label*="theme"]')||document.querySelector(".theme-toggle");e&&(e.setAttribute("title","There is no light out here"),e.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),document.getElementById("no-light-modal").classList.add("show"),document.getElementById("modal-backdrop").classList.add("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),!1},!0)),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}),document.addEventListener("keydown",function(e){e.key==="Escape"&&closeNoLightModal()})</script><meta property="og:url" content="http://localhost:61585/posts/get_sp_item_id/"><meta property="og:site_name" content="SomethingWentWrong.dev"><meta property="og:title" content="How to Get SharePoint Item ID Using Microsoft Graph API"><meta property="og:description" content="Introduction When working with Microsoft Graph API to automate SharePoint operations (like writing script outputs, saving reports, updating Excel files), we can’t just use file paths. We need to work with unique identifiers - specifically - the file ID.
This guide walks you through the process of finding a SharePoint item ID by navigating the site hierarchy using Graph API Explorer.
The Goal In this example, we’ll find the ID of an Excel file located deep within a SharePoint site structure:"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-08T00:00:00+00:00"><meta property="article:modified_time" content="2026-02-08T00:00:00+00:00"><meta property="article:tag" content="Powershell"><meta property="article:tag" content="Microsoft-Graph"><meta property="article:tag" content="Sharepoint"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to Get SharePoint Item ID Using Microsoft Graph API"><meta name=twitter:description content="Introduction
When working with Microsoft Graph API to automate SharePoint operations (like writing script outputs, saving reports, updating Excel files), we can&rsquo;t just use file paths. We need to work with unique identifiers - specifically - the file ID.
This guide walks you through the process of finding a SharePoint item ID by navigating the site hierarchy using Graph API Explorer.
The Goal
In this example, we&rsquo;ll find the ID of an Excel file located deep within a SharePoint site structure:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:61585/posts/"},{"@type":"ListItem","position":2,"name":"How to Get SharePoint Item ID Using Microsoft Graph API","item":"http://localhost:61585/posts/get_sp_item_id/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to Get SharePoint Item ID Using Microsoft Graph API","name":"How to Get SharePoint Item ID Using Microsoft Graph API","description":"Introduction When working with Microsoft Graph API to automate SharePoint operations (like writing script outputs, saving reports, updating Excel files), we can\u0026rsquo;t just use file paths. We need to work with unique identifiers - specifically - the file ID.\nThis guide walks you through the process of finding a SharePoint item ID by navigating the site hierarchy using Graph API Explorer.\nThe Goal In this example, we\u0026rsquo;ll find the ID of an Excel file located deep within a SharePoint site structure:\n","keywords":["powershell","microsoft-graph","sharepoint"],"articleBody":"Introduction When working with Microsoft Graph API to automate SharePoint operations (like writing script outputs, saving reports, updating Excel files), we can’t just use file paths. We need to work with unique identifiers - specifically - the file ID.\nThis guide walks you through the process of finding a SharePoint item ID by navigating the site hierarchy using Graph API Explorer.\nThe Goal In this example, we’ll find the ID of an Excel file located deep within a SharePoint site structure:\nTarget: Important file about cats\nBefore You Start Important: To follow this guide, you need one of these permissions:\nGlobal Administrator role in Microsoft 365 Site Owner/Admin permissions for the specific SharePoint site (not SharePoint Administrator role) 1. Get the SharePoint Site ID First, we need the Site ID. There are several ways to obtain this, here is my favorite method:\nAdd _api/site/id to your SharePoint site URL\nFor example, my site is:\nhttps://wst3j.sharepoint.com/sites/SalesandMarketing I navigate to:\nhttps://wst3j.sharepoint.com/sites/SalesandMarketing/_api/site/id The response is in JSON format and the value in the Edm.Guid property is the Site ID.\nUsing the SharePoint REST API to get Site ID\n2. Get the Drive ID Now that we have the Site ID, we’ll use Microsoft Graph Explorer to find the Drive ID.\nNavigate to Graph Explorer Make sure you’re logged in with appropriate permissions Run this query (replace with your actual Site ID): https://graph.microsoft.com/v1.0/sites//drives?$select=name,id Using $select filter to get only name and id properties\nThe response will contain the Drive ID(s) for your SharePoint site.\n3. Navigate the Folder Structure With both the Site ID and Drive ID, we can now navigate through the folder hierarchy to find our file.\nList Root Folder Contents Start by listing the root folder contents:\nhttps://graph.microsoft.com/v1.0/sites//drives//root/children This returns all items in the root of your SharePoint document library:\nRoot folder items with their IDs\nThe same folders as seen in SharePoint interface\nNavigate to Subfolders In our example, the file is located under Marketing, so we’ll navigate there next using the folder’s ID from the previous response:\nhttps://graph.microsoft.com/v1.0/sites//drives//items//children Contents of the Marketing folder\nThe same folder via GUI\nContinue Navigating We continue this process, replacing the folder ID in the URL as we go deeper:\nNext level - Cat Pictures folder:\nhttps://graph.microsoft.com/v1.0/sites//drives//items//children Getting closer to our target file\nFinal level - Kitties folder:\nhttps://graph.microsoft.com/v1.0/sites//drives//items//children Found it! Our Excel file with its ID\nUsing the File ID Once you have the file information from the API response, you can use either:\nid - The unique identifier for Graph API operations webUrl - The direct web URL to the file Both can be used in subsequent Graph API calls to interact with the file (read, write, update, etc.).\nSummary The process to get a SharePoint item ID involves:\nObtaining the Site ID using _api/site/id Getting the Drive ID via Graph API Navigating the folder hierarchy step-by-step using the children endpoint Extracting the final file ID from the response ","wordCount":"488","inLanguage":"en","datePublished":"2026-02-08T00:00:00Z","dateModified":"2026-02-08T00:00:00Z","author":{"@type":"Person","name":"Przemek"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:61585/posts/get_sp_item_id/"},"publisher":{"@type":"Organization","name":"SomethingWentWrong.dev","logo":{"@type":"ImageObject","url":"http://localhost:61585/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:61585/ accesskey=h title="SomethingWentWrong.dev (Alt + H)"><img src=http://localhost:61585/favicon.ico alt aria-label=logo height=35>SomethingWentWrong.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:61585/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:61585/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:61585/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:61585/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:61585/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">How to Get SharePoint Item ID Using Microsoft Graph API</h1><div class=post-meta><span title='2026-02-08 00:00:00 +0000 UTC'>February 8, 2026</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>488 words</span>&nbsp;·&nbsp;<span>Przemek</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/przemekokon/somethingwentwrong/tree/main/content/posts/get_sp_item_id.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>When working with Microsoft Graph API to automate SharePoint operations (like writing script outputs, saving reports, updating Excel files), we can&rsquo;t just use file paths. We need to work with unique identifiers - specifically - the file ID.</p><p>This guide walks you through the process of finding a SharePoint item ID by navigating the site hierarchy using Graph API Explorer.</p><h2 id=the-goal>The Goal<a hidden class=anchor aria-hidden=true href=#the-goal>#</a></h2><p>In this example, we&rsquo;ll find the ID of an Excel file located deep within a SharePoint site structure:</p><figure><img loading=lazy src=/images/sp_id_general.png alt="Example Excel file in SharePoint"><figcaption><p>Target: Important file about cats</p></figcaption></figure><h2 id=before-you-start>Before You Start<a hidden class=anchor aria-hidden=true href=#before-you-start>#</a></h2><p><strong>Important:</strong> To follow this guide, you need one of these permissions:</p><ul><li><strong>Global Administrator</strong> role in Microsoft 365</li><li><strong>Site Owner/Admin</strong> permissions for the specific SharePoint site (not SharePoint Administrator role)</li></ul><h2 id=1-get-the-sharepoint-site-id>1. Get the SharePoint Site ID<a hidden class=anchor aria-hidden=true href=#1-get-the-sharepoint-site-id>#</a></h2><p>First, we need the Site ID. There are several ways to obtain this, here is my favorite method:</p><p><strong>Add <code>_api/site/id</code> to your SharePoint site URL</strong></p><p>For example, my site is:</p><pre tabindex=0><code>https://wst3j.sharepoint.com/sites/SalesandMarketing
</code></pre><p>I navigate to:</p><pre tabindex=0><code>https://wst3j.sharepoint.com/sites/SalesandMarketing/_api/site/id
</code></pre><p>The response is in JSON format and the value in the <code>Edm.Guid</code> property is the Site ID.</p><figure><img loading=lazy src=/images/sp_id_site_id_url.png alt="SharePoint API endpoint for Site ID"><figcaption><p>Using the SharePoint REST API to get Site ID</p></figcaption></figure><h2 id=2-get-the-drive-id>2. Get the Drive ID<a hidden class=anchor aria-hidden=true href=#2-get-the-drive-id>#</a></h2><p>Now that we have the Site ID, we&rsquo;ll use Microsoft Graph Explorer to find the Drive ID.</p><ol><li>Navigate to <a href=https://developer.microsoft.com/en-us/graph/graph-explorer>Graph Explorer</a></li><li>Make sure you&rsquo;re logged in with appropriate permissions</li><li>Run this query (replace <code>&lt;Site_ID></code> with your actual Site ID):</li></ol><pre tabindex=0><code>https://graph.microsoft.com/v1.0/sites/&lt;Site_ID&gt;/drives?$select=name,id
</code></pre><figure><img loading=lazy src=/images/sp_id_explorer_1.png alt="Graph Explorer showing drives"><figcaption><p>Using $select filter to get only name and id properties</p></figcaption></figure><p>The response will contain the Drive ID(s) for your SharePoint site.</p><h2 id=3-navigate-the-folder-structure>3. Navigate the Folder Structure<a hidden class=anchor aria-hidden=true href=#3-navigate-the-folder-structure>#</a></h2><p>With both the Site ID and Drive ID, we can now navigate through the folder hierarchy to find our file.</p><h3 id=list-root-folder-contents>List Root Folder Contents<a hidden class=anchor aria-hidden=true href=#list-root-folder-contents>#</a></h3><p>Start by listing the root folder contents:</p><pre tabindex=0><code>https://graph.microsoft.com/v1.0/sites/&lt;Site_ID&gt;/drives/&lt;Drive_ID&gt;/root/children
</code></pre><p>This returns all items in the root of your SharePoint document library:</p><figure><img loading=lazy src=/images/sp_id_folders_ids.png alt="Root folder contents in Graph Explorer"><figcaption><p>Root folder items with their IDs</p></figcaption></figure><figure><img loading=lazy src=/images/sp_id_folders_gui.png alt="Root folder in SharePoint UI"><figcaption><p>The same folders as seen in SharePoint interface</p></figcaption></figure><h3 id=navigate-to-subfolders>Navigate to Subfolders<a hidden class=anchor aria-hidden=true href=#navigate-to-subfolders>#</a></h3><p>In our example, the file is located under <strong>Marketing</strong>, so we&rsquo;ll navigate there next using the folder&rsquo;s ID from the previous response:</p><pre tabindex=0><code>https://graph.microsoft.com/v1.0/sites/&lt;Site_ID&gt;/drives/&lt;Drive_ID&gt;/items/&lt;Marketing_Folder_ID&gt;/children
</code></pre><p><figure><img loading=lazy src=/images/sp_id_folder_gui_2.png alt="Marketing folder contents"><figcaption><p>Contents of the Marketing folder</p></figcaption></figure><figure><img loading=lazy src=/images/sp_id_folder_gui_2a.png alt="Marketing folder contents"><figcaption><p>The same folder via GUI</p></figcaption></figure></p><h3 id=continue-navigating>Continue Navigating<a hidden class=anchor aria-hidden=true href=#continue-navigating>#</a></h3><p>We continue this process, replacing the folder ID in the URL as we go deeper:</p><p><strong>Next level - Cat Pictures folder:</strong></p><pre tabindex=0><code>https://graph.microsoft.com/v1.0/sites/&lt;Site_ID&gt;/drives/&lt;Drive_ID&gt;/items/&lt;Cat_Pictures_Folder_ID&gt;/children
</code></pre><figure><img loading=lazy src=/images/sp_id_folder_gui_3.png alt="Cat Pictures folder contents"><figcaption><p>Getting closer to our target file</p></figcaption></figure><p><strong>Final level - Kitties folder:</strong></p><pre tabindex=0><code>https://graph.microsoft.com/v1.0/sites/&lt;Site_ID&gt;/drives/&lt;Drive_ID&gt;/items/&lt;Kitties_Folder_ID&gt;/children
</code></pre><figure><img loading=lazy src=/images/sp_id_folder_gui_4.png alt="Final folder with target Excel file"><figcaption><p>Found it! Our Excel file with its ID</p></figcaption></figure><h2 id=using-the-file-id>Using the File ID<a hidden class=anchor aria-hidden=true href=#using-the-file-id>#</a></h2><p>Once you have the file information from the API response, you can use either:</p><ul><li><strong><code>id</code></strong> - The unique identifier for Graph API operations</li><li><strong><code>webUrl</code></strong> - The direct web URL to the file</li></ul><p>Both can be used in subsequent Graph API calls to interact with the file (read, write, update, etc.).</p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>The process to get a SharePoint item ID involves:</p><ol><li>Obtaining the Site ID using <code>_api/site/id</code></li><li>Getting the Drive ID via Graph API</li><li>Navigating the folder hierarchy step-by-step using the <code>children</code> endpoint</li><li>Extracting the final file ID from the response</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:61585/tags/powershell/>Powershell</a></li><li><a href=http://localhost:61585/tags/microsoft-graph/>Microsoft-Graph</a></li><li><a href=http://localhost:61585/tags/sharepoint/>Sharepoint</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=http://localhost:61585/>SomethingWentWrong.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>