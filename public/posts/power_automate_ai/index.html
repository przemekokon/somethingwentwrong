<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>When PowerAutomate Can't Regex - Let AI Do The Parsing | SomethingWentWrong.dev</title><meta name=keywords content="powerautomate,AI,automation"><meta name=description content="How to use AI prompts in Power Automate to extract data from emails when regex isn't an option"><meta name=author content="Przemek"><link rel=canonical href=http://localhost:1313/posts/power_automate_ai/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/power_automate_ai/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><style>.no-light-modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#0a0a0a;border:2px solid #404040;padding:2rem;border-radius:8px;z-index:9999;box-shadow:0 0 80px rgba(0,0,0,.9);max-width:400px;text-align:center}.no-light-modal.show{display:block;animation:modalFadeIn .3s ease}@keyframes modalFadeIn{from{opacity:0;transform:translate(-50%,-45%)}to{opacity:1;transform:translate(-50%,-50%)}}.no-light-modal p{color:#b0b0b0;margin:1rem 0;line-height:1.6;font-size:1.1rem}.no-light-modal p.subtitle{color:#666;font-size:.9em;font-style:italic}.no-light-modal button{background:#1a1a1a;border:1px solid #404040;padding:.75rem 2rem;border-radius:4px;cursor:pointer;color:#888;font-weight:400;font-size:1rem;margin-top:1rem;transition:all .2s ease}.no-light-modal button:hover{background:#252525;border-color:#555;color:#aaa}.modal-backdrop{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:9998}.modal-backdrop.show{display:block;animation:backdropFadeIn .3s ease}@keyframes backdropFadeIn{from{opacity:0}to{opacity:1}}</style><div class=modal-backdrop id=modal-backdrop onclick=closeNoLightModal()></div><div class=no-light-modal id=no-light-modal><p>There is no light out here.</p><p class=subtitle>Dark mode is the only mode.</p><button onclick=closeNoLightModal()>Accept</button></div><script>function closeNoLightModal(){document.getElementById("no-light-modal").classList.remove("show"),document.getElementById("modal-backdrop").classList.remove("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("theme-toggle")||document.querySelector('[aria-label*="theme"]')||document.querySelector(".theme-toggle");e&&(e.setAttribute("title","There is no light out here"),e.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),document.getElementById("no-light-modal").classList.add("show"),document.getElementById("modal-backdrop").classList.add("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),!1},!0)),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}),document.addEventListener("keydown",function(e){e.key==="Escape"&&closeNoLightModal()})</script><meta property="og:url" content="http://localhost:1313/posts/power_automate_ai/"><meta property="og:site_name" content="SomethingWentWrong.dev"><meta property="og:title" content="When PowerAutomate Can't Regex - Let AI Do The Parsing"><meta property="og:description" content="How to use AI prompts in Power Automate to extract data from emails when regex isn't an option"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-03T00:00:00+00:00"><meta property="article:modified_time" content="2026-02-03T00:00:00+00:00"><meta property="article:tag" content="Powerautomate"><meta property="article:tag" content="AI"><meta property="article:tag" content="Automation"><meta name=twitter:card content="summary"><meta name=twitter:title content="When PowerAutomate Can't Regex - Let AI Do The Parsing"><meta name=twitter:description content="How to use AI prompts in Power Automate to extract data from emails when regex isn't an option"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"When PowerAutomate Can't Regex - Let AI Do The Parsing","item":"http://localhost:1313/posts/power_automate_ai/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"When PowerAutomate Can't Regex - Let AI Do The Parsing","name":"When PowerAutomate Can\u0027t Regex - Let AI Do The Parsing","description":"How to use AI prompts in Power Automate to extract data from emails when regex isn't an option","keywords":["powerautomate","AI","automation"],"articleBody":"Problem I need to monitor my mailbox for certain ticket emails and extract specific data from them. Classic automation stuff.\nThe catch? Power Automate doesn’t support regex.\nThe Workaround Power Automate has this “Run a prompt” action that lets you use GPT to process text.\nThe idea is simple:\nGet the email Feed it to AI with instructions Get structured JSON back Do whatever you want with clean data General flow description The flow has the following steps:\nGet an email from a specific mailbox folder (emails get there via inbox rule) Convert HTML (email body) into TEXT (for raw output) Run a prompt to get specific info from the email Save the prompt output into JSON to easily proceed In my scenario I use a switch as I work with two types of emails If the email is about DL - save a new row into DL sheet If the email is about a group mailbox - save a new row into GroupMailboxes sheet The Flow Here’s the general structure:\nThe full flow - nothing too crazy\nLet’s break down each step.\nWhen a new email arrives (V3) I have an inbox rule that moves specific emails to a dedicated folder. The flow just monitors that folder.\nYou could also filter directly in Power Automate using subject/from conditions, but inbox rules give you more flexibility.\nMonitoring a specific folder keeps things clean\nHTML to text Email bodies are HTML. AI works better with plain text. This step does the conversion.\nJust pass the email body - nothing fancy\nRun a prompt This is where the magic happens. A few important things to follow:\nThe prompt needs to be strict. AI loves to be helpful and chatty. You don’t want “Here are the extracted values based on your email content:”. You want just the JSON.\nUse JSON output mode. There’s an “Output: JSON” setting in the prompt configuration. Use it. This makes Power Automate automatically parse the response into structured fields.\nUse the standard model, not mini. Mini works, but standard works better.\nAdd content = data source. The “Add content” button is where you connect your input data. In my case, it’s the plain text email body from the previous step.\nTest multiple times. AI can be… creative. Run your prompt with different test inputs before going live.\nThe prompt action with JSON output enabled\nI recommend using the standard model, not mini\nHere’s the prompt I ended up with:\n1 2 3 4 5 6 7 8 9 10 11 12 13 Based on the email content, extract the following information and return ONLY a JSON object with no additional text: { \"CatalogTaskNumber\": \"extracted SCTASK number or null\", \"RequestType\": \"DL or GroupMailbox\", \"DLName\": \"name of distribution list if RequestType is DL, otherwise null\", \"MailboxAddress\": \"email address if RequestType is GroupMailbox, otherwise null\" } Rules: - RequestType must be exactly \"DL\" or \"GroupMailbox\" based on the request - DLName can be either a name or an address - Return only valid JSON, no markdown, no explanation Parse JSON Here’s where it gets weird.\nSo the prompt already returns JSON. And Power Automate parses it automatically when you use JSON output mode. So why would you add another “Parse JSON” action to parse.. JSON with JSON?\nGood question.\nBut here’s what happened: the automatic parsing worked fine for DL emails. For GroupMailbox emails RequestType was null. Even though the raw JSON response clearly had the correct value.\nThe fix: Add a “Parse JSON” action manually and use the raw Text field from the prompt response. Define your own schema with proper null handling.\nParse the Text output, not the structured fields\nFor content, use: ‘Text’ - basically a prompt response.\nSchema (with null support):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 { \"type\": \"object\", \"properties\": { \"CatalogTaskNumber\": { \"type\": [\"string\", \"null\"] }, \"RequestType\": { \"type\": [\"string\", \"null\"] }, \"DLName\": { \"type\": [\"string\", \"null\"] }, \"MailboxAddress\": { \"type\": [\"string\", \"null\"] } } } You can build your own schema based on output from the prompt and using sample payload to generate it.\nSwitch In my case, I have two types of requests that need to go to different Excel files. The Switch action handles this based on RequestType.\nDL goes one way, GroupMailbox goes another\nImportant: Use the expression body('Parse_JSON')?['RequestType'] - not just body('Parse_JSON') (that returns the whole object and Switch will complain about expecting a string).\nThe cases are DL and GroupMailbox - case-sensitive, so make sure your prompt returns exactly these values.\nAdd a row into a table Standard Excel action. Map the JSON fields to your table columns.\nJSON fields map directly to Excel columns\nSummary Emails can be easily accessed using Power Automate. Excel tables can be easily written using Power Automate. The issue starts when a specific part of an email should be written into Excel - regex would be helpful, if supported.\nIt’s even quite funny, we got a working AI in Power Automate faster than regex support..\n","wordCount":"843","inLanguage":"en","datePublished":"2026-02-03T00:00:00Z","dateModified":"2026-02-03T00:00:00Z","author":{"@type":"Person","name":"Przemek"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/power_automate_ai/"},"publisher":{"@type":"Organization","name":"SomethingWentWrong.dev","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="SomethingWentWrong.dev (Alt + H)">SomethingWentWrong.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">When PowerAutomate Can't Regex - Let AI Do The Parsing</h1><div class=post-description>How to use AI prompts in Power Automate to extract data from emails when regex isn't an option</div><div class=post-meta><span title='2026-02-03 00:00:00 +0000 UTC'>February 3, 2026</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>843 words</span>&nbsp;·&nbsp;<span>Przemek</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/przemekokon/somethingwentwrong/tree/main/content/posts/power_automate_AI.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#problem>Problem</a></li><li><a href=#the-workaround>The Workaround</a></li><li><a href=#general-flow-description>General flow description</a></li><li><a href=#the-flow>The Flow</a></li><li><a href=#when-a-new-email-arrives-v3>When a new email arrives (V3)</a></li><li><a href=#html-to-text>HTML to text</a></li><li><a href=#run-a-prompt>Run a prompt</a></li><li><a href=#parse-json>Parse JSON</a></li><li><a href=#switch>Switch</a></li><li><a href=#add-a-row-into-a-table>Add a row into a table</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></details></div><div class=post-content><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>I need to monitor my mailbox for certain ticket emails and extract specific data from them. Classic automation stuff.</p><p>The catch? Power Automate doesn&rsquo;t support regex.</p><h2 id=the-workaround>The Workaround<a hidden class=anchor aria-hidden=true href=#the-workaround>#</a></h2><p>Power Automate has this &ldquo;Run a prompt&rdquo; action that lets you use GPT to process text.</p><p>The idea is simple:</p><ol><li>Get the email</li><li>Feed it to AI with instructions</li><li>Get structured JSON back</li><li>Do whatever you want with clean data</li></ol><h2 id=general-flow-description>General flow description<a hidden class=anchor aria-hidden=true href=#general-flow-description>#</a></h2><p>The flow has the following steps:</p><ol><li>Get an email from a specific mailbox folder (emails get there via inbox rule)</li><li>Convert HTML (email body) into TEXT (for raw output)</li><li>Run a prompt to get specific info from the email</li><li>Save the prompt output into JSON to easily proceed</li><li>In my scenario I use a switch as I work with two types of emails</li><li>If the email is about DL - save a new row into DL sheet</li><li>If the email is about a group mailbox - save a new row into GroupMailboxes sheet</li></ol><h2 id=the-flow>The Flow<a hidden class=anchor aria-hidden=true href=#the-flow>#</a></h2><p>Here&rsquo;s the general structure:</p><figure><img loading=lazy src=/images/flow_general.png alt="Power Automate flow overview"><figcaption><p>The full flow - nothing too crazy</p></figcaption></figure><p>Let&rsquo;s break down each step.</p><h2 id=when-a-new-email-arrives-v3>When a new email arrives (V3)<a hidden class=anchor aria-hidden=true href=#when-a-new-email-arrives-v3>#</a></h2><p>I have an inbox rule that moves specific emails to a dedicated folder. The flow just monitors that folder.</p><p>You could also filter directly in Power Automate using subject/from conditions, but inbox rules give you more flexibility.</p><figure><img loading=lazy src=/images/flow_email.png alt="Email trigger configuration"><figcaption><p>Monitoring a specific folder keeps things clean</p></figcaption></figure><h2 id=html-to-text>HTML to text<a hidden class=anchor aria-hidden=true href=#html-to-text>#</a></h2><p>Email bodies are HTML. AI works better with plain text. This step does the conversion.</p><figure><img loading=lazy src=/images/flow_html.png alt="HTML to text action"><figcaption><p>Just pass the email body - nothing fancy</p></figcaption></figure><h2 id=run-a-prompt>Run a prompt<a hidden class=anchor aria-hidden=true href=#run-a-prompt>#</a></h2><p>This is where the magic happens. A few important things to follow:</p><p><strong>The prompt needs to be strict.</strong> AI loves to be helpful and chatty. You don&rsquo;t want &ldquo;Here are the extracted values based on your email content:&rdquo;. You want just the JSON.</p><p><strong>Use JSON output mode.</strong> There&rsquo;s an &ldquo;Output: JSON&rdquo; setting in the prompt configuration. Use it. This makes Power Automate automatically parse the response into structured fields.</p><p><strong>Use the standard model, not mini.</strong> Mini works, but standard works better.</p><p><strong>Add content = data source.</strong> The &ldquo;Add content&rdquo; button is where you connect your input data. In my case, it&rsquo;s the plain text email body from the previous step.</p><p><strong>Test multiple times.</strong> AI can be&mldr; creative. Run your prompt with different test inputs before going live.</p><figure><img loading=lazy src=/images/flow_prompt_general.png alt="Run a prompt configuration"><figcaption><p>The prompt action with JSON output enabled</p></figcaption></figure><figure><img loading=lazy src=/images/flow_prompt_details.png alt="Prompt details and model selection"><figcaption><p>I recommend using the standard model, not mini</p></figcaption></figure><p>Here&rsquo;s the prompt I ended up with:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Based on the email content, extract the following information and return ONLY a JSON object with no additional text:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;CatalogTaskNumber&#34;: &#34;extracted SCTASK number or null&#34;,
</span></span><span class=line><span class=cl>  &#34;RequestType&#34;: &#34;DL or GroupMailbox&#34;,
</span></span><span class=line><span class=cl>  &#34;DLName&#34;: &#34;name of distribution list if RequestType is DL, otherwise null&#34;,
</span></span><span class=line><span class=cl>  &#34;MailboxAddress&#34;: &#34;email address if RequestType is GroupMailbox, otherwise null&#34;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Rules:
</span></span><span class=line><span class=cl>- RequestType must be exactly &#34;DL&#34; or &#34;GroupMailbox&#34; based on the request
</span></span><span class=line><span class=cl>- DLName can be either a name or an address
</span></span><span class=line><span class=cl>- Return only valid JSON, no markdown, no explanation
</span></span></code></pre></td></tr></table></div></div><h2 id=parse-json>Parse JSON<a hidden class=anchor aria-hidden=true href=#parse-json>#</a></h2><p>Here&rsquo;s where it gets weird.</p><p>So the prompt already returns JSON. And Power Automate parses it automatically when you use JSON output mode. So why would you add another &ldquo;Parse JSON&rdquo; action to parse.. JSON with JSON?</p><p>Good question.</p><p>But here&rsquo;s what happened: the automatic parsing worked fine for DL emails. For GroupMailbox emails <code>RequestType</code> was <code>null</code>. Even though the raw JSON response clearly had the correct value.</p><p><strong>The fix:</strong> Add a &ldquo;Parse JSON&rdquo; action manually and use the raw <code>Text</code> field from the prompt response. Define your own schema with proper null handling.</p><figure><img loading=lazy src=/images/flow_parse.png alt="Parse JSON configuration"><figcaption><p>Parse the Text output, not the structured fields</p></figcaption></figure><p>For content, use: &lsquo;Text&rsquo; - basically a prompt response.</p><p>Schema (with null support):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;object&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CatalogTaskNumber&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;string&#34;</span><span class=p>,</span> <span class=s2>&#34;null&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;RequestType&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;string&#34;</span><span class=p>,</span> <span class=s2>&#34;null&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;DLName&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;string&#34;</span><span class=p>,</span> <span class=s2>&#34;null&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;MailboxAddress&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;string&#34;</span><span class=p>,</span> <span class=s2>&#34;null&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>You can build your own schema based on output from the prompt and using sample payload to generate it.</p><h2 id=switch>Switch<a hidden class=anchor aria-hidden=true href=#switch>#</a></h2><p>In my case, I have two types of requests that need to go to different Excel files. The Switch action handles this based on <code>RequestType</code>.</p><figure><img loading=lazy src=/images/flow_switch_all.png alt="Switch action for routing"><figcaption><p>DL goes one way, GroupMailbox goes another</p></figcaption></figure><p>Important: Use the expression <code>body('Parse_JSON')?['RequestType']</code> - not just <code>body('Parse_JSON')</code> (that returns the whole object and Switch will complain about expecting a string).</p><p>The cases are <code>DL</code> and <code>GroupMailbox</code> - case-sensitive, so make sure your prompt returns exactly these values.</p><h2 id=add-a-row-into-a-table>Add a row into a table<a hidden class=anchor aria-hidden=true href=#add-a-row-into-a-table>#</a></h2><p>Standard Excel action. Map the JSON fields to your table columns.</p><figure><img loading=lazy src=/images/flow_excel.png alt="Excel add row action"><figcaption><p>JSON fields map directly to Excel columns</p></figcaption></figure><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>Emails can be easily accessed using Power Automate. Excel tables can be easily written using Power Automate. The issue starts when a specific part of an email should be written into Excel - regex would be helpful, if supported.</p><p>It&rsquo;s even quite funny, we got a working AI in Power Automate faster than regex support..</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/powerautomate/>Powerautomate</a></li><li><a href=http://localhost:1313/tags/ai/>AI</a></li><li><a href=http://localhost:1313/tags/automation/>Automation</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=http://localhost:1313/>SomethingWentWrong.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>