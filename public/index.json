[{"content":"The Problem Creating distribution lists in bulk is simple. But updating extended attributes? That\u0026rsquo;s where it gets interesting.\nCSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Create groups:\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is simple. But updating extended attributes? That\u0026rsquo;s where it gets interesting.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eCSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eCreate groups:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is simple. But updating extended attributes? That\u0026rsquo;s where it gets interesting.\nCSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Create groups:\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is simple. But updating extended attributes? That\u0026rsquo;s where it gets interesting.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eCSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eCreate groups:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nCSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Create groups:\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eCSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eCreate groups:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Create groups:\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eCreate groups:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \u003cspan class=\"n\"\u003e-type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -type Security -OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \u003cspan class=\"n\"\u003e-type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -type Security `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \u003cspan class=\"n\"\u003e-type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name `-PrimarySmtpAddress $_.mail `-Type Security `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-Type Security `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com To be continued\u0026hellip; [More content coming soon]\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"to-be-continued\"\u003eTo be continued\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e[More content coming soon]\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command Set-Distributiongroup -Identity \u0026ldquo;Fancy Group\u0026rdquo; -msExchExtensionAttribute20 \u0026ldquo;Lorem Ipsum\u0026rdquo; won\u0026rsquo;t work for two reasons\nThere is no such command and no such group. ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command Set-Distributiongroup -Identity \u0026ldquo;Fancy Group\u0026rdquo; -msExchExtensionAttribute20 \u0026ldquo;Lorem Ipsum\u0026rdquo; won\u0026rsquo;t work for two reasons\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command Set-DistributionGroup -Identity \u0026ldquo;Fancy Group\u0026rdquo; -msExchExtensionAttribute20 \u0026ldquo;Lorem Ipsum\u0026rdquo; won\u0026rsquo;t work for two reasons\nThere is no such command and no such group. ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command Set-DistributionGroup -Identity \u0026ldquo;Fancy Group\u0026rdquo; -msExchExtensionAttribute20 \u0026ldquo;Lorem Ipsum\u0026rdquo; won\u0026rsquo;t work for two reasons\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 2 3 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; ``` won\u0026#39;t work for two reasons 1. There is no such command and no such group. ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eSet-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Fancy Group\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-msExchExtensionAttribute20\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Lorem Ipsum\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e```\u003c/span\u003e \u003cspan class=\"n\"\u003ewon\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ework\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etwo\u003c/span\u003e \u003cspan class=\"n\"\u003ereasons\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"n\"\u003eThere\u003c/span\u003e \u003cspan class=\"n\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003ecommand\u003c/span\u003e \u003cspan class=\"n\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003egroup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 2 3 4 5 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; ``` won\u0026#39;t work for two reasons 1. There is no such command and no such group. ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eSet-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Fancy Group\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-msExchExtensionAttribute20\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Lorem Ipsum\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e```\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ewon\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ework\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etwo\u003c/span\u003e \u003cspan class=\"n\"\u003ereasons\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"n\"\u003eThere\u003c/span\u003e \u003cspan class=\"n\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003ecommand\u003c/span\u003e \u003cspan class=\"n\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003egroup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 2 3 4 5 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; ``` won\u0026#39;t work for two reasons 1. There is no such command and no such group. ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eSet-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Fancy Group\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-msExchExtensionAttribute20\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Lorem Ipsum\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e```\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ewon\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ework\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etwo\u003c/span\u003e \u003cspan class=\"n\"\u003ereasons\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"n\"\u003eThere\u003c/span\u003e \u003cspan class=\"n\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003ecommand\u003c/span\u003e \u003cspan class=\"n\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003egroup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 2 3 4 5 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; ``` won\u0026#39;t work for two reasons: There is no such command and no such group. ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eSet-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Fancy Group\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-msExchExtensionAttribute20\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Lorem Ipsum\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e```\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ewon\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ework\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etwo\u003c/span\u003e \u003cspan class=\"n\"\u003ereasons\u003c/span\u003e\u003cspan class=\"err\"\u003e:\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eThere\u003c/span\u003e \u003cspan class=\"n\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003ecommand\u003c/span\u003e \u003cspan class=\"n\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003egroup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=AzureDL,OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eSet-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Fancy Group\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-msExchExtensionAttribute20\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Lorem Ipsum\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ewon\u0026rsquo;t work for two reasons:\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName GroupType PrimarySmtpAddress Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eSet-DistributionGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Fancy Group\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-msExchExtensionAttribute20\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Lorem Ipsum\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ewon\u0026rsquo;t work for two reasons:\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group, Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003e Not.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A simple command\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; won\u0026rsquo;t work for two reasons:\nThere is no such command and no such group.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA simple command\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below command won\u0026rsquo;t work as there is no such command.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below command won\u0026rsquo;t work as there is no such command.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by a DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN:\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN:\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter - so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to a DN: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it: ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for keeping values uniqe): ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): Resolution ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): Resolution ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): Resolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): If we work with just one group - it\u0026rsquo;s something we can live with (or just do an update on GUI)\nResolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): If we work with just one group - it\u0026rsquo;s something we can live with (or just do an update on GUI)\nResolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): If we work with a single group - it\u0026rsquo;s something we can live with (or just do an update on GUI)\nResolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is: Set-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nResolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is: Set-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nResolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\nSet-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nResolution: Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\nSet-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nWhat about bulk? Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\nSet-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nWhat about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\nSet-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nOr we can use pipeline and filter:\n\u0026lsquo;Get-ADGroup -Filter \u0026ldquo;mail -eq \u0026lsquo;Another.Fancy.Group@example.com\u0026rsquo;\u0026rdquo; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026ldquo;Lorem Ipsum\u0026rdquo;}`\nWhat about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\nSet-ADGroup -Identity 'Another Fancy Group-1-292223989' -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nOr we can use pipeline and filter:\nGet-ADGroup -Filter \u0026quot;mail -eq 'Another.Fancy.Group@example.com'\u0026quot; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026quot;Lorem Ipsum\u0026quot;}\nWhat about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} Or we can use pipeline and filter:\n1 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} Or we can use pipeline and filter:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; |` Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} Or we can use pipeline and filter:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; |` Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} Or we can use pipeline and filter:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} Or we can use filter: and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter: and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? - Pipeline and Filter ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $groups = Import-Csv \u0026#34;C:\\temp\\pszem\\items.csv\u0026#34; foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail)  msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail)  msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail)  msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail)  msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it uses below as Identity parameter\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it doesn\u0026rsquo;t accept the same for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) so we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): So, a proper command, for a single group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for a Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly (in loop).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk? For multiple groups, we can use the same CSV file we used for groups creation, query for mail attribute and update objects accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can use a CSV file we used for groups creation, query for mail attribute and update objects accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can use an import CSV for data input, query by mail attribute and update objects accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can use import CSV for data input, query by mail attribute and update objects accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query by mail attribute and update objects accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update objects accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } ","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV)\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup `-Name $_.name `-PrimarySmtpAddress $_.mail `-OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; `-Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003ePrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"n\"\u003eOrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e`-\u003c/span\u003e\u003cspan class=\"nb\"\u003eType \u003c/span\u003e\u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 8 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But when it comes to update msExchExtensionAttribute.. A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-when-it-comes-to-update-msexchextensionattribute\"\u003eBut when it comes to update msExchExtensionAttribute..\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But Updating msExchExtensionAttribute Is Different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut Updating msExchExtensionAttribute Is Different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But Updating msExchExtensionAttribute Is Different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut Updating msExchExtensionAttribute Is Different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Given that, we cannot query by DL \u0026ldquo;name\u0026rdquo; or alias, as DL name (which in fact is sAMAccountName) is being updated by AD by adding random numbers to it (for uniqe values): A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the original DL name: A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the \u0026ldquo;original\u0026rdquo; DL name: A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;: A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL name: A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;: A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;: A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;: Example: \u0026ldquo;Another Fancy Group\u0026rdquo; becomes \u0026ldquo;Another Fancy Group-1-292223989\u0026rdquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;: Example: \u0026ldquo;Another Fancy Group\u0026rdquo; becomes \u0026ldquo;Another Fancy Group-1-292223989\u0026rdquo; A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026ldquo;Another Fancy Group\u0026rdquo; becomes \u0026ldquo;Another Fancy Group-1-292223989\u0026rdquo; A proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nSummary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Dealing with Extended DL Attributes (in Bulk)"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"Problem Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nSummary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"problem\"\u003eProblem\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you run a script in production and see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found Or when the output looks like this:\n1 2 @{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (more or less) What went wrong along the way Lessons learned the hard way What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; articles Copy-pasted Microsoft docs Solutions that only work in labs Perfect code that never fails Coming Soon I\u0026rsquo;m documenting some recent projects:\nBuilding an enterprise vacation calendar in Power Apps Automating M365 license compliance Debugging DMARC alignment at scale Spoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth writing about.\nHave questions? Find me on GitHub or LinkedIn.\n","permalink":"http://localhost:1313/posts/welcome/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you run a script in production and see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr when the output looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJohn\u003c/span\u003e \u003cspan class=\"n\"\u003eDoe\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eDisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eJane\u003c/span\u003e \u003cspan class=\"n\"\u003eSmith\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with Microsoft 365, PowerShell, and Power Platform.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nSummary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek I\u0026rsquo;m an IT architect specializing in Microsoft 365, PowerShell automation, and Power Platform solutions.\nBy day, I manage email infrastructure and automation systems for a large enterprise. By night (and weekends), I document the interesting problems I encounter.\nWhy This Blog? Every complex IT project has a story - the things that went wrong, the unexpected behaviors, the workarounds that became permanent solutions.\nMicrosoft documentation is great for the happy path. This blog is for everything else.\nWhat I Write About PowerShell automation at enterprise scale Power Apps \u0026amp; Power Automate patterns and gotchas Exchange Online administration and troubleshooting Email security (DMARC, DKIM, SPF implementations) Azure integrations and automation Contact Find me on:\nLinkedIn GitHub Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"}]