[{"content":"Welcome to SomethingWentWrong.dev If you work in IT long enough, you develop a special relationship with error messages.\nThat moment when you confidently run a script in production, only to see:\n1 2 Get-Mailbox : The operation couldn\u0026#39;t be performed because object \u0026#39;user@domain.com\u0026#39; couldn\u0026#39;t be found on \u0026#39;DC01.domain.local\u0026#39;. Or worse - when it doesn\u0026rsquo;t error, but the output looks like this:\n@{DisplayName=John Doe} @{DisplayName=Jane Smith} Because you forgot -ExpandProperty. Again.\nWhat This Blog Is About I\u0026rsquo;m an IT architect working with M365, PowerShell, and Power Platform at scale.\nThis blog documents:\nReal problems from production environments Step-by-step solutions (not just \u0026ldquo;here\u0026rsquo;s the final script\u0026rdquo;) What went wrong along the way Lessons learned (usually the hard way) What You Won\u0026rsquo;t Find Here Generic \u0026ldquo;10 PowerShell tips\u0026rdquo; listicles Copy-pasted Microsoft docs Solutions that only work in demo environments Perfect code that never fails What You Will Find Detailed walkthroughs of complex projects Power Apps patterns that actually scale Exchange Online automation that handles errors DMARC implementations that don\u0026rsquo;t break email Honest discussions of what didn\u0026rsquo;t work Coming Soon I\u0026rsquo;m working on a series about building an enterprise vacation calendar in Power Apps.\nSpoiler: A lot went wrong. But that\u0026rsquo;s what makes it worth documenting.\nHave a project that went sideways? I\u0026rsquo;d love to hear about it - find me on LinkedIn or GitHub.\n","permalink":"http://localhost:1313/posts/hello-world/","summary":"\u003ch2 id=\"welcome-to-somethingwentwrongdev\"\u003eWelcome to SomethingWentWrong.dev\u003c/h2\u003e\n\u003cp\u003eIf you work in IT long enough, you develop a special relationship with error messages.\u003c/p\u003e\n\u003cp\u003eThat moment when you confidently run a script in production, only to see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Mailbox\u003c/span\u003e \u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eThe\u003c/span\u003e \u003cspan class=\"n\"\u003eoperation\u003c/span\u003e \u003cspan class=\"n\"\u003ecouldn\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t be performed because \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eobject \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"nv\"\u003e@domain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; couldn\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003ebe\u003c/span\u003e \u003cspan class=\"n\"\u003efound\u003c/span\u003e \u003cspan class=\"n\"\u003eon\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DC01.domain.local\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eOr worse - when it \u003cstrong\u003edoesn\u0026rsquo;t\u003c/strong\u003e error, but the output looks like this:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e@{DisplayName=John Doe}\n@{DisplayName=Jane Smith}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBecause you forgot \u003ccode\u003e-ExpandProperty\u003c/code\u003e. Again.\u003c/p\u003e\n\u003ch2 id=\"what-this-blog-is-about\"\u003eWhat This Blog Is About\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m an IT architect working with M365, PowerShell, and Power Platform at scale.\u003c/p\u003e","title":"Something Went Wrong - And That's The Point"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nSummary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nSummary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nSummary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n\u0026ldquo;I learn from the mistakes of those who follow my advice.\u0026rdquo;\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"}]