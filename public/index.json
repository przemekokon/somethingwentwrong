[{"content":"The Problem You\u0026rsquo;ve probably been there: trying to restore a user from the recycle bin, only to discover a conflict object blocking your way. You attempt to delete it through the usual channels, and boom - Exchange slaps you with an error that basically says \u0026ldquo;nope, not happening.\u0026rdquo;\nThe standard Remove-MailContact cmdlet just won\u0026rsquo;t cut it when dealing with these stubborn objects. That\u0026rsquo;s where Microsoft Graph API comes to the rescue.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eYou\u0026rsquo;ve probably been there: trying to restore a user from the recycle bin, only to discover a conflict object blocking your way. You attempt to delete it through the usual channels, and boom - Exchange slaps you with an error that basically says \u0026ldquo;nope, not happening.\u0026rdquo;\u003c/p\u003e\n\u003cp\u003eThe standard \u003ccode\u003eRemove-MailContact\u003c/code\u003e cmdlet just won\u0026rsquo;t cut it when dealing with these stubborn objects. That\u0026rsquo;s where Microsoft Graph API comes to the rescue.\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem You\u0026rsquo;ve probably been there: trying to restore a user from the recycle bin, only to discover a conflict object blocking your way. You attempt to delete it through the usual channels, and boom - Exchange slaps you with an error that basically says \u0026ldquo;nope, not happening.\u0026rdquo;\nThe standard Remove-MailContact cmdlet just won\u0026rsquo;t cut it when dealing with these stubborn objects. That\u0026rsquo;s where Microsoft Graph API comes to the rescue.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eYou\u0026rsquo;ve probably been there: trying to restore a user from the recycle bin, only to discover a conflict object blocking your way. You attempt to delete it through the usual channels, and boom - Exchange slaps you with an error that basically says \u0026ldquo;nope, not happening.\u0026rdquo;\u003c/p\u003e\n\u003cp\u003eThe standard \u003ccode\u003eRemove-MailContact\u003c/code\u003e cmdlet just won\u0026rsquo;t cut it when dealing with these stubborn objects. That\u0026rsquo;s where Microsoft Graph API comes to the rescue.\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online [Entra] scenario - trying to remove an orphaned (maybe used to be synced) object.\nAnd getting slapped in the face.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online [Entra] scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eAnd getting slapped in the face.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give you the unique identifier for the mail contact.\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nAnd getting slapped in the face.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eAnd getting slapped in the face.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give you the unique identifier for the mail contact.\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nAnd getting slapped in the face with error.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eAnd getting slapped in the face with error.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give you the unique identifier for the mail contact.\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object. Probably due to conflict while restoring an object (at least I never did it for other reason)\nAnd getting slapped in the face with error.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object. Probably due to conflict while restoring an object (at least I never did it for other reason)\u003c/p\u003e\n\u003cp\u003eAnd getting slapped in the face with error.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to conflict while restoring an object (at least I never did it for other reason).\nAnd getting slapped in the face with error.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cp\u003eAnd getting slapped in the face with error.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nAnd getting slapped in the face with error.\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cp\u003eAnd getting slapped in the face with error.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Here\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s the step-by-step process to forcefully remove that troublesome contact object.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Before we delete anything, let\u0026rsquo;s make absolutely sure we\u0026rsquo;re targeting the correct object. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove. Check the displayName, mail properties, and other attributes to be certain.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Once you\u0026rsquo;ve confirmed you have the right object, execute the deletion:\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Prerequisites: You\u0026rsquo;ll need the Microsoft Graph PowerShell module installed and appropriate permissions (typically Directory.ReadWrite.All) No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Why Graph instead of Exchange cmdlets?: Sometimes conflict objects exist in a state where Exchange cmdlets can\u0026rsquo;t touch them, but Graph API operates at the directory level and can handle these edge cases When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how url looks like When You\u0026rsquo;ll Need This This approach is particularly useful when:\nStandard Remove-MailContact fails with errors You\u0026rsquo;re dealing with conflict objects after failed restore operations Objects are in a \u0026ldquo;stuck\u0026rdquo; state due to directory sync issues You need to clean up after mailbox migration problems Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how url looks like Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how url looks like Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how uri looks like Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes No undo: Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how uri looks like Yes, URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; Important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how uri looks like Yes, URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how uri looks like Yes, URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how uri looks like URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Conclusion While most contact removal operations work fine with standard Exchange cmdlets, having Graph API in your toolkit means you\u0026rsquo;re never truly stuck. Sometimes you just need to go deeper into the directory layer to get things done.\nRemember: with great power comes great responsibility - always verify before you delete!\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give you the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate an object.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Contact in Microsoft 365 with PowerShell"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"How to Force Remove Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps and trust me, I\u0026rsquo;m an engineer.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not a day and we must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps and trust me, I\u0026rsquo;m an engineer.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nProbably due to a conflict while restoring an object (at least I never did it for other reason).\nGetting slapped in the face with error\nThe Solution Just follow these steps.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cp\u003eProbably due to a conflict while restoring an object (at least I never did it for other reason).\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Just follow these steps.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eJust follow these steps.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi, I\u0026rsquo;m Przemek Something went wrong and I became an engineer instead of a nepo baby.\nBy day, I manage cloud infrastructure and try to automate things for a large enterprise. By night, I document the problems that made me question my life choices.\nWhy This Blog? I\u0026rsquo;m still figuring that out.\nIf I come up with something that sounds good on LinkedIn, I\u0026rsquo;ll update this section.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi Something went wrong and I became an engineer instead of a nepo baby.\nSometimes I document here some of the problems that made me question my life choices.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"","permalink":"http://localhost:1313/posts/ext_att_group_graph/","summary":"","title":"Ext_att_group_graph"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hi Something went wrong and I became an engineer instead of a nepo baby.\nSometimes I document here some of the problems that made me question my life choices.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"","permalink":"http://localhost:1313/posts/ext_att_group_graph/","summary":"","title":"Ext_att_group_graph"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or less important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hello there, Something went wrong and I became an engineer instead of a nepo baby.\nSometimes I document here some of the problems that made me question my life choices.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR. Or just write me an email, I like emails.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"","permalink":"http://localhost:1313/posts/ext_att_group_graph/","summary":"","title":"Ext_att_group_graph"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or Less Important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hello there, Something went wrong and I became an engineer instead of a nepo baby.\nSometimes I document here some of the problems that made me question my life choices.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR. Or just write me an email, I like emails.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"","permalink":"http://localhost:1313/posts/license_assign_graph/","summary":"","title":"License_assign_graph"},{"content":"","permalink":"http://localhost:1313/posts/ext_att_group_graph/","summary":"","title":"Ext_att_group_graph"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or Less Important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hello there, Something went wrong and I became an engineer instead of a nepo baby.\nSometimes I document here some of the problems that made me question my life choices.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR. Or just write me an email, I like emails.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"},{"content":"","permalink":"http://localhost:1313/posts/ext_att_group_graph/","summary":"","title":"Ext_att_group_graph"},{"content":"That\u0026rsquo;s pretty simple:\nAdding:\n1 Get-Content C:\\Temp\\mm.txt | foreach {Set-MgUserLicense -UserId $_ -AddLicenses @{SkuID = \u0026#39;2ced8a00-3ed1-4295-ab7c-57170ff28e58\u0026#39;} -RemoveLicenses @()} Removal:\n1 Get-Content C:\\Temp\\mm.txt | foreach {Set-MgUserLicense -UserId $_ -RemoveLicenses @(\u0026#39;b30411f5-fea1-4a59-9ad9-3db7c7ead579\u0026#39;) -AddLicenses @{}} Check for license SkuId\nGet-MgUserLicenseDetail -UserId \u0026lt;UPN\u0026gt; Or Get-MgSubscribedSku | fl SkuPartNumber, skuid\n","permalink":"http://localhost:1313/posts/license_assign_graph/","summary":"\u003cp\u003eThat\u0026rsquo;s pretty simple:\u003c/p\u003e\n\u003cp\u003eAdding:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"n\"\u003eC:\u003c/span\u003e\u003cspan class=\"p\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003eTemp\u003c/span\u003e\u003cspan class=\"p\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nb\"\u003eSet-MgUserLicense\u003c/span\u003e \u003cspan class=\"n\"\u003e-UserId\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e \u003cspan class=\"n\"\u003e-AddLicenses\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eSkuID\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;2ced8a00-3ed1-4295-ab7c-57170ff28e58\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"n\"\u003e-RemoveLicenses\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e()}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eRemoval:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"n\"\u003eC:\u003c/span\u003e\u003cspan class=\"p\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003eTemp\u003c/span\u003e\u003cspan class=\"p\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003emm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nb\"\u003eSet-MgUserLicense\u003c/span\u003e \u003cspan class=\"n\"\u003e-UserId\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e \u003cspan class=\"n\"\u003e-RemoveLicenses\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;b30411f5-fea1-4a59-9ad9-3db7c7ead579\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003e-AddLicenses\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e{}}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eCheck for license SkuId\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eGet-MgUserLicenseDetail -UserId \u0026lt;UPN\u0026gt;\u003c/code\u003e\nOr\n\u003ccode\u003eGet-MgSubscribedSku | fl SkuPartNumber, skuid\u003c/code\u003e\u003c/p\u003e","title":"Assign a license via Graph API"},{"content":"The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\nGetting slapped in the face with error\nThe Solution Two words: Graph API.\nStep 1: Get the Mail Contact ID First, we need to identify the exact object we\u0026rsquo;re dealing with:\n1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.\nStep 2: Verify the Object in Graph API Better safe than sorry- let\u0026rsquo;s do a double check. Replace \u0026lt;ID\u0026gt; with the ID from Step 1:\n1 Invoke-MgGraphRequest -Method GET -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; -OutputType PSObject Review the output to confirm this is indeed the object you want to remove.\nStep 3: Force Delete via Graph API Exterminate.\n1 Invoke-MgGraphRequest -Method DELETE -Uri \u0026#34;https://graph.microsoft.com/beta/directoryObjects/\u0026lt;ID\u0026gt;\u0026#34; More or Less Important Notes Graph API deletions are immediate - there\u0026rsquo;s no confirmation prompt, so triple-check that ID Here is how a sample uri looks like: URI - not URL (uniform resource identifier) Summary Someday we will get Remove-MgContact but today is not the day. We must use a workaround.\n","permalink":"http://localhost:1313/posts/mail_contact_delete/","summary":"\u003ch2 id=\"the-problem\"\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eClassic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.\u003c/p\u003e\n\u003cfigure\u003e\r\n    \u003cimg loading=\"lazy\" src=\"/images/contact_removal_error.png\"\r\n         alt=\"Error message when trying to remove contact\"/\u003e \u003cfigcaption\u003e\r\n            \u003cp\u003eGetting slapped in the face with error\u003c/p\u003e\r\n        \u003c/figcaption\u003e\r\n\u003c/figure\u003e\r\n\n\u003ch2 id=\"the-solution\"\u003eThe Solution\u003c/h2\u003e\n\u003cp\u003eTwo words: Graph API.\u003c/p\u003e\n\u003ch3 id=\"step-1-get-the-mail-contact-id\"\u003eStep 1: Get the Mail Contact ID\u003c/h3\u003e\n\u003cp\u003eFirst, we need to identify the exact object we\u0026rsquo;re dealing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-MailContact\u003c/span\u003e \u003cspan class=\"n\"\u003elorem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eipsum\u003c/span\u003e\u003cspan class=\"nv\"\u003e@contoso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecom\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eFormat-List\u003c/span\u003e \u003cspan class=\"n\"\u003eId\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eThis will give the unique identifier for the mail contact.\u003c/p\u003e\n\u003ch3 id=\"step-2-verify-the-object-in-graph-api\"\u003eStep 2: Verify the Object in Graph API\u003c/h3\u003e\n\u003cp\u003eBetter safe than sorry- let\u0026rsquo;s do a double check. Replace \u003ccode\u003e\u0026lt;ID\u0026gt;\u003c/code\u003e with the ID from Step 1:\u003c/p\u003e","title":"Force Removal Orphaned Contact in Microsoft 365"},{"content":"Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\nApp permissions consent pop-up\nIn most scenarios, this pop-up can be bypassed.\nHiding consent pop-up This requries a single PowerShell command:\n1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set\nWe can get guids using PowerShell:\nEnvironment GUID:\n1 Get-AdminPowerAppEnvironment [\u0026#39;Environment Display Name\u0026#39;] | Select EnvironmentName App GUID:\n1 Get-AdminPowerApp [\u0026#39;App Display Name\u0026#39;] -EnvironmentName [Guid] | Select AppName What happens under the hood? After the command runs successfully, the BypassConsent flag is set to True for the app.\nIf the connector meets certain criteria (listed below), the app assumes consent is granted.\nThis does NOT grant tenant-level delegated access (like an Entra registered app). If a user lacks permissions to access data, the app still denies access.\nIn short: The app behaves as the user already clicked \u0026ldquo;Allow\u0026rdquo;.\nConsent bypassing criteria:\nWorks only for Microsoft connectors (except..) Does not work for Entra and Azure DevOps connectors Does not work for third-party connectors (like Slack or Smartsheet) Connectors must use OAuth or No Auth Power Automate flows require separate consent Bypassing consent for the PowerApp does not automatically handle Power Automate flows triggered from the app.\nWhat happens:\nThe app works correctly (displays data, buttons respond) App shows flow related errors Flow audit log shows authentication/connection failures Why this occurs:\nPower Apps and Power Automate have separate consent mechanisms Flows execute in the user\u0026rsquo;s context and require their own connection references Each user needs established connections to the connectors used in flows (Sending E-mails, Approvals etc.) Bypassing app consent doesn\u0026rsquo;t create these flow connections automatically This is a separate configuration challenge that requires additional setup beyond the app consent bypass. It will be covered in another blog post.\nNotes These commands are available in module: Microsoft.PowerApps.Administration.PowerShell Command reversing this setting is 1 Clear-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] After connector changes, updates, or major logic updates, it\u0026rsquo;s good practice to reset the BypassConsent flag Summary Use Set-AdminPowerAppApisToBypassConsent to hide consent pop-ups.\nThis doesn\u0026rsquo;t change permissions - just removes the prompt.\n","permalink":"http://localhost:1313/posts/power_apps_consent/","summary":"\u003ch2 id=\"permissions-consent-pop-up\"\u003ePermissions Consent Pop-up\u003c/h2\u003e\n\u003cp\u003eEvery new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.\u003c/p\u003e\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/consent.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eApp permissions consent pop-up\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\n\u003cp\u003eIn most scenarios, this pop-up can be bypassed.\u003c/p\u003e\n\u003ch2 id=\"hiding-consent-pop-up\"\u003eHiding consent pop-up\u003c/h2\u003e\n\u003cp\u003eThis requries a single PowerShell command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nb\"\u003eSet-AdminPowerAppApisToBypassConsent\u003c/span\u003e \u003cspan class=\"n\"\u003e-EnvironmentName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003e-AppName\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eExpected result:\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass_result.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \r\n \u003c/figure\u003e\r\n\n\u003cfigure\u003e\r\n     \u003cimg loading=\"lazy\" src=\"/images/bypass.png\"\r\n          alt=\"Power Apps Grant Consent\"/\u003e \u003cfigcaption\u003e\r\n             \u003cp\u003eBypassConsent flag is set\u003c/p\u003e\r\n         \u003c/figcaption\u003e\r\n \u003c/figure\u003e\r\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWe can get guids using PowerShell:\u003c/strong\u003e\u003c/p\u003e","title":"How to Get Rid of Power Apps Permissions Consent Form"},{"content":"Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\n1 2 3 4 5 Get-Content .\\rooms.txt | % { Write-Host \u0026#34;Working on $_\u0026#34; -ForegroundColor Cyan Add-MailboxFolderPermission -Identity \u0026#34;$($_.Trim()):\\Calendar\u0026#34; -User \u0026#34;przemek@contoso.com\u0026#34; -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (\u0026rsquo; room@contoso.com\u0026rsquo; -\u0026gt; \u0026lsquo;room@contoso.com\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in Germany and \u0026ldquo;Calendier\u0026rdquo; for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions ","permalink":"http://localhost:1313/posts/room_perm_bulk/","summary":"\u003ch2 id=\"just-a-simple-one-liner\"\u003eJust a simple one-liner\u003c/h2\u003e\n\u003cp\u003eWhen you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003erooms\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Working on \u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-ForegroundColor\u003c/span\u003e \u003cspan class=\"n\"\u003eCyan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nb\"\u003eAdd-MailboxFolderPermission\u003c/span\u003e \u003cspan class=\"n\"\u003e-Identity\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTrim\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\\Calendar\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-User\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;przemek@contoso.com\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AccessRights\u003c/span\u003e \u003cspan class=\"n\"\u003eReviewer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"notes\"\u003eNotes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eText file we import via \u003ccode\u003eGet-Content\u003c/code\u003e contains a room email address per line\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.Trim\u003c/code\u003e is being used to remove blank spaces in TXT file - (\u0026rsquo; \u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo; -\u0026gt; \u0026lsquo;\u003ca href=\"mailto:room@contoso.com\"\u003eroom@contoso.com\u003c/a\u003e\u0026rsquo;) - it\u0026rsquo;s just a safety feature I like to use\u003c/li\u003e\n\u003cli\u003eIn some tenants, the calendar folder name might be localized (for example \u0026ldquo;Kalendarz\u0026rdquo; in Poland, \u0026ldquo;Kalender\u0026rdquo; in  Germany and \u0026ldquo;Calendier\u0026rdquo; for France)\u003c/li\u003e\n\u003cli\u003eIf permissions are already granted for an user, you need to either remove these and re-add or use \u003ccode\u003eSet-MailboxFolderPermissions\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Assign Calendar Permissions in Bulk"},{"content":"The easy part Creating distribution lists in bulk is quite simple.\nJust a CSV file:\n1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop\n1 2 3 4 5 6 7 Import-Csv .\\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit \u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39; -Type Security } Result:\nName DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\n1 Set-DistributionGroup -Identity \u0026#34;Fancy Group\u0026#34; -msExchExtensionAttribute20 \u0026#34;Lorem Ipsum\u0026#34; For this matter we must use Set-ADGroup but it accepts these for Identity parameter:\nA distinguished name A GUID (objectGUID) A security identifier (objectSid) A SAM account name (sAMAccountName) Since Active Directory adds random numbers to the sAMAccountName for uniqueness, we cannot reliably query by the DL \u0026ldquo;name\u0026rdquo;:\nExample: \u0026lsquo;Another Fancy Group\u0026rsquo; becomes \u0026lsquo;Another Fancy Group-1-292223989\u0026rsquo;\nA proper command, for the Another Fancy Group is:\n1 Set-ADGroup -Identity \u0026#39;Another Fancy Group-1-292223989\u0026#39; -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} We can also use filter and pipeline:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Replace @{msExchExtensionAttribute20=\u0026#34;Lorem Ipsum\u0026#34;} What about bulk update? For multiple groups, we can import a CSV file for data input, query objects by mail attribute and update these accordingly in loop.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #CSV file should contain \u0026#39;mail\u0026#39; header $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Replace @{msExchExtensionAttribute20 = \u0026#34;Lorem Ipsum\u0026#34;} Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 has been set\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } We can filter for any other property - as long as it\u0026rsquo;s uniqe (and covered in a CSV). Just update script\u0026rsquo;s line 7.\nClearing the Attribute To remove the value from msExchExtensionAttribute20:\nSingle group:\n1 2 Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;Another.Fancy.Group@example.com\u0026#39;\u0026#34; | Set-ADGroup -Clear msExchExtensionAttribute20 Bulk clear from CSV:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $groups = Import-Csv .\\groups.csv foreach ($g in $groups) { $group = Get-ADGroup -Filter \u0026#34;mail -eq \u0026#39;$($g.mail)\u0026#39;\u0026#34; -Properties mail if ($group) { Set-ADGroup -Identity $group.DistinguishedName -Clear msExchExtensionAttribute20 Write-Host \u0026#34;OK: $($g.mail) -\u0026gt; msExchExtensionAttribute20 cleared\u0026#34; -ForegroundColor Green } else { Write-Host \u0026#34;ERROR: DL not found $($g.mail)\u0026#34; -ForegroundColor Red } } Summary This is a hybrid/on-premises scenario - less common now days, but still relevant for organizations running Exchange hybrid or syncing on-prem AD to Entra ID.\n","permalink":"http://localhost:1313/posts/msatt20/","summary":"\u003ch2 id=\"the-easy-part\"\u003eThe easy part\u003c/h2\u003e\n\u003cp\u003eCreating distribution lists in bulk is quite simple.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJust a CSV file:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csv\" data-lang=\"csv\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eFancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eFancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAnother Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eAnother.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eNot That Fancy Group\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003eNot.That.Fancy.Group@example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eAnd for-each loop\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Csv\u003c/span\u003e \u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ecsv\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eForEach-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eNew-DistributionGroup\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ename\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-PrimarySmtpAddress\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003email\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-OrganizationalUnit\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;OU=Groups,DC=wrong,DC=went,DC=something,DC=dev\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003e-Type\u003c/span\u003e \u003cspan class=\"n\"\u003eSecurity\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eResult:\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eDisplayName\u003c/th\u003e\n          \u003cth\u003eGroupType\u003c/th\u003e\n          \u003cth\u003ePrimarySmtpAddress\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eFancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Fancy.Group@example.com\"\u003eFancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eAnother Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Another.Fancy.Group@example.com\"\u003eAnother.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eNot That Fancy Group\u003c/td\u003e\n          \u003ctd\u003eUniversal, SecurityEnabled\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"mailto:Not.That.Fancy.Group@example.com\"\u003eNot.That.Fancy.Group@example.com\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"but-updating-msexchextensionattribute-is-different\"\u003eBut updating msExchExtensionAttribute is different\u003c/h2\u003e\n\u003cp\u003eA below won\u0026rsquo;t work as there is no such command under Set-DistributionGroup.\u003c/p\u003e","title":"Updating Distribution List Extended Attributes with PowerShell"},{"content":"Hello there, Something went wrong and I became an engineer instead of a nepo baby.\nSometimes I document here some of the problems that made me question my life choices.\nContact Find me on:\nGitHub LinkedIn Mail: przemek@somethingwentwrong.dev Questions about a post? See that \u0026ldquo;Suggest Changes\u0026rdquo; link at the bottom? That goes to GitHub - open an issue or PR. Or just write me an email, I like emails.\n","permalink":"http://localhost:1313/about/","summary":"Who writes this and why","title":"About"}]