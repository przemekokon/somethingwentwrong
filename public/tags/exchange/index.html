<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=61585&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Exchange | SomethingWentWrong.dev</title><meta name=keywords content><meta name=description content="Real-world problems from production"><meta name=author content="Przemek"><link rel=canonical href=http://localhost:61585/tags/exchange/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=http://localhost:61585/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:61585/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:61585/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:61585/apple-touch-icon.png><link rel=mask-icon href=http://localhost:61585/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=http://localhost:61585/tags/exchange/index.xml title=rss><link rel=alternate hreflang=en href=http://localhost:61585/tags/exchange/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><style>.no-light-modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#0a0a0a;border:2px solid #404040;padding:2rem;border-radius:8px;z-index:9999;box-shadow:0 0 80px rgba(0,0,0,.9);max-width:400px;text-align:center}.no-light-modal.show{display:block;animation:modalFadeIn .3s ease}@keyframes modalFadeIn{from{opacity:0;transform:translate(-50%,-45%)}to{opacity:1;transform:translate(-50%,-50%)}}.no-light-modal p{color:#b0b0b0;margin:1rem 0;line-height:1.6;font-size:1.1rem}.no-light-modal p.subtitle{color:#666;font-size:.9em;font-style:italic}.no-light-modal button{background:#1a1a1a;border:1px solid #404040;padding:.75rem 2rem;border-radius:4px;cursor:pointer;color:#888;font-weight:400;font-size:1rem;margin-top:1rem;transition:all .2s ease}.no-light-modal button:hover{background:#252525;border-color:#555;color:#aaa}.modal-backdrop{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:9998}.modal-backdrop.show{display:block;animation:backdropFadeIn .3s ease}@keyframes backdropFadeIn{from{opacity:0}to{opacity:1}}</style><div class=modal-backdrop id=modal-backdrop onclick=closeNoLightModal()></div><div class=no-light-modal id=no-light-modal><p>There is no light out here.</p><p class=subtitle>Dark mode is the only mode.</p><button onclick=closeNoLightModal()>Accept</button></div><script>function closeNoLightModal(){document.getElementById("no-light-modal").classList.remove("show"),document.getElementById("modal-backdrop").classList.remove("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("theme-toggle")||document.querySelector('[aria-label*="theme"]')||document.querySelector(".theme-toggle");e&&(e.setAttribute("title","There is no light out here"),e.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),document.getElementById("no-light-modal").classList.add("show"),document.getElementById("modal-backdrop").classList.add("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),!1},!0)),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}),document.addEventListener("keydown",function(e){e.key==="Escape"&&closeNoLightModal()})</script><meta property="og:url" content="http://localhost:61585/tags/exchange/"><meta property="og:site_name" content="SomethingWentWrong.dev"><meta property="og:title" content="Exchange"><meta property="og:description" content="Real-world problems from production"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Exchange"><meta name=twitter:description content="Real-world problems from production"></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:61585/ accesskey=h title="SomethingWentWrong.dev (Alt + H)"><img src=http://localhost:61585/favicon.ico alt aria-label=logo height=35>SomethingWentWrong.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:61585/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:61585/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:61585/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=http://localhost:61585/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:61585/tags/>Tags</a></div><h1>Exchange
<a href=/tags/exchange/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Get SP item ID</h2></header><div class=entry-content><p>Sometimes in script you would like to for example write something to an excel file using graph api - for this purpose you will need to know a file ID - as you cannot just specify a file path..
here’s how to
In my example we are going to get an ID of this file: important file about cats'
first we need to know a sharepoint site ID, there is a few options to get this, I like the simple one
...</p></div><footer class=entry-footer><span title='2026-02-08 00:00:00 +0000 UTC'>February 8, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>83 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Get SP item ID" href=http://localhost:61585/posts/get_sp_item_id/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Recursive Member Count for Distribution Lists</h2></header><div class=entry-content><p>Get-GroupMemberReport PowerShell script to audit Distribution Lists and Microsoft 365 Groups membership using Microsoft Graph API. Returns transitive (recursive) member counts - including all nested group members.
Why? Get-DistributionGroupMember only returns direct members, not nested Exchange Online cmdlets have pagination timeouts on large tenants Graph API’s Get-MgGroupTransitiveMemberCount solves both problems Requirements PowerShell 5.1+ or PowerShell 7+ Microsoft Graph PowerShell SDK Permissions: Group.Read.All, Directory.Read.All Usage 1 2 3 4 5 6 7 8 9 10 11 # Distribution Lists only .\Get-GroupMemberReport.ps1 -DL # Microsoft 365 Groups only .\Get-GroupMemberReport.ps1 -M365 # Both types .\Get-GroupMemberReport.ps1 -All # Test mode - first ~100 DLs or M365 .\Get-GroupMemberReport.ps1 -DL/M365 -TestLimit 100 Output CSV file with columns:
...</p></div><footer class=entry-footer><span title='2026-02-06 00:00:00 +0000 UTC'>February 6, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>200 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Recursive Member Count for Distribution Lists" href=http://localhost:61585/posts/dls_members_count/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Force Removal Orphaned Contact in Microsoft 365</h2></header><div class=entry-content><p>The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.
Getting slapped in the face with error
The Solution Two words: Graph API.
Step 1: Get the Mail Contact ID First, we need to identify the exact object we’re dealing with:
1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.
Step 2: Verify the Object in Graph API Better safe than sorry- let’s do a double check. Replace &lt;ID> with the ID from Step 1:
...</p></div><footer class=entry-footer><span title='2026-01-26 00:00:00 +0000 UTC'>January 26, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>177 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Force Removal Orphaned Contact in Microsoft 365" href=http://localhost:61585/posts/mail_contact_delete/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Assign Calendar Permissions in Bulk</h2></header><div class=entry-content><p>Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.
1 2 3 4 5 Get-Content .\rooms.txt | % { Write-Host "Working on $_" -ForegroundColor Cyan Add-MailboxFolderPermission -Identity "$($_.Trim()):\Calendar" -User "przemek@contoso.com" -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (’ room@contoso.com’ -> ‘room@contoso.com’) - it’s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example “Kalendarz” in Poland, “Kalender” in Germany and “Calendier” for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions</p></div><footer class=entry-footer><span title='2026-01-10 00:00:00 +0000 UTC'>January 10, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>147 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Assign Calendar Permissions in Bulk" href=http://localhost:61585/posts/room_perm_bulk/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Updating Distribution List Extended Attributes with PowerShell</h2></header><div class=entry-content><p>The easy part Creating distribution lists in bulk is quite simple.
Just a CSV file:
1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop
1 2 3 4 5 6 7 Import-Csv .\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit 'OU=Groups,DC=wrong,DC=went,DC=something,DC=dev' -Type Security } Result:
Name DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won’t work as there is no such command under Set-DistributionGroup.
...</p></div><footer class=entry-footer><span title='2026-01-02 00:00:00 +0000 UTC'>January 2, 2026</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>440 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Updating Distribution List Extended Attributes with PowerShell" href=http://localhost:61585/posts/msatt20/></a></article></main><footer class=footer><span>&copy; 2026 <a href=http://localhost:61585/>SomethingWentWrong.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>