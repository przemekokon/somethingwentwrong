<!doctype html><html lang=en dir=auto data-theme=dark><head><meta name=generator content="Hugo 0.153.2"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=58330&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SomethingWentWrong.dev</title><meta name=keywords content="PowerShell,Power Apps,M365,Exchange,Azure,Automation"><meta name=description content="Real-world problems from production"><meta name=author content="Przemek"><link rel=canonical href=http://localhost:58330/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=http://localhost:58330/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:58330/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:58330/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:58330/apple-touch-icon.png><link rel=mask-icon href=http://localhost:58330/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=http://localhost:58330/index.xml title=rss><link rel=alternate type=application/json href=http://localhost:58330/index.json title=json><link rel=alternate hreflang=en href=http://localhost:58330/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><style>.no-light-modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#0a0a0a;border:2px solid #404040;padding:2rem;border-radius:8px;z-index:9999;box-shadow:0 0 80px rgba(0,0,0,.9);max-width:400px;text-align:center}.no-light-modal.show{display:block;animation:modalFadeIn .3s ease}@keyframes modalFadeIn{from{opacity:0;transform:translate(-50%,-45%)}to{opacity:1;transform:translate(-50%,-50%)}}.no-light-modal p{color:#b0b0b0;margin:1rem 0;line-height:1.6;font-size:1.1rem}.no-light-modal p.subtitle{color:#666;font-size:.9em;font-style:italic}.no-light-modal button{background:#1a1a1a;border:1px solid #404040;padding:.75rem 2rem;border-radius:4px;cursor:pointer;color:#888;font-weight:400;font-size:1rem;margin-top:1rem;transition:all .2s ease}.no-light-modal button:hover{background:#252525;border-color:#555;color:#aaa}.modal-backdrop{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:9998}.modal-backdrop.show{display:block;animation:backdropFadeIn .3s ease}@keyframes backdropFadeIn{from{opacity:0}to{opacity:1}}</style><div class=modal-backdrop id=modal-backdrop onclick=closeNoLightModal()></div><div class=no-light-modal id=no-light-modal><p>There is no light out here.</p><p class=subtitle>Dark mode is the only mode.</p><button onclick=closeNoLightModal()>Accept</button></div><script>function closeNoLightModal(){document.getElementById("no-light-modal").classList.remove("show"),document.getElementById("modal-backdrop").classList.remove("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("theme-toggle")||document.querySelector('[aria-label*="theme"]')||document.querySelector(".theme-toggle");e&&(e.setAttribute("title","There is no light out here"),e.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),document.getElementById("no-light-modal").classList.add("show"),document.getElementById("modal-backdrop").classList.add("show"),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),!1},!0)),document.body.classList.remove("light"),document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")}),document.addEventListener("keydown",function(e){e.key==="Escape"&&closeNoLightModal()})</script><meta property="og:url" content="http://localhost:58330/"><meta property="og:site_name" content="SomethingWentWrong.dev"><meta property="og:title" content="SomethingWentWrong.dev"><meta property="og:description" content="Real-world problems from production"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="SomethingWentWrong.dev"><meta name=twitter:description content="Real-world problems from production"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"SomethingWentWrong.dev","url":"http://localhost:58330/","description":"Real-world problems from production","logo":"http://localhost:58330/favicon.ico","sameAs":["https://github.com/przemekokon","http://www.linkedin.com/in/przemek-okon","mailto:przemek@somethingwentwrong.dev","index.xml"]}</script></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:58330/ accesskey=h title="SomethingWentWrong.dev (Alt + H)"><img src=http://localhost:58330/favicon.ico alt aria-label=logo height=35>SomethingWentWrong.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:58330/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:58330/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:58330/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>This is my technical scratchpad.</h1></header><div class=entry-content><p>You&rsquo;ll find here PowerShell, Graph API, Microsoft Office Copilot 365 stuff (whatever it&rsquo;s called today).</p><p>If something here helps you - great.</p><p>If it breaks your production - sorry, but I learn from the mistakes of those who follow my advice.</p></div><footer class=entry-footer><div class=social-icons><a href=https://github.com/przemekokon target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=http://www.linkedin.com/in/przemek-okon target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=mailto:przemek@somethingwentwrong.dev target=_blank rel="noopener noreferrer me" title=Email><svg viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a><a href=index.xml target=_blank rel="noopener noreferrer me" title=Rss><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>When PowerAutomate Can't Regex - Let AI Do The Parsing</h2></header><div class=entry-content><p>Problem I need to monitor my mailbox for certain ticket emails and extract specific data from them. Classic automation stuff.
The catch? Power Automate doesn’t support regex.
The Workaround Power Automate has this “Run a prompt” action that lets you use GPT to process text.
The idea is simple:
Get the email Feed it to AI with instructions Get structured JSON back Do whatever you want with clean data General flow description The flow has the following steps:
...</p></div><footer class=entry-footer><span title='2026-02-03 00:00:00 +0000 UTC'>February 3, 2026</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>843 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to When PowerAutomate Can't Regex - Let AI Do The Parsing" href=http://localhost:58330/posts/power_automate_ai/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Force Removal Orphaned Contact in Microsoft 365</h2></header><div class=entry-content><p>The Problem</p></div><footer class=entry-footer><span title='2026-01-30 00:00:00 +0000 UTC'>January 30, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>2 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Force Removal Orphaned Contact in Microsoft 365" href=http://localhost:58330/posts/ext_att_group_graph/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Assign licenses in bulk via Graph API</h2></header><div class=entry-content><p>Add:
1 Get-Content &lt;file path> | foreach {Set-MgUserLicense -UserId $_ -AddLicenses @{SkuID = '2ced8a00...'} -RemoveLicenses @()} Remove:
1 Get-Content &lt;file path> | foreach {Set-MgUserLicense -UserId $_ -RemoveLicenses @('3db7c7ead579...') -AddLicenses @{}} Check for a license SkuId:
Get-MgUserLicenseDetail -UserId &lt;UPN>orGet-MgSubscribedSku | fl SkuPartNumber, skuid
File path is a TXT file containing UPNs one-per-line.</p></div><footer class=entry-footer><span title='2026-01-26 00:00:00 +0000 UTC'>January 26, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>51 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Assign licenses in bulk via Graph API" href=http://localhost:58330/posts/license_assign_graph/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Force Removal Orphaned Contact in Microsoft 365</h2></header><div class=entry-content><p>The Problem Classic Exchange Online scenario - trying to remove an orphaned (maybe used to be synced) object.
Getting slapped in the face with error
The Solution Two words: Graph API.
Step 1: Get the Mail Contact ID First, we need to identify the exact object we’re dealing with:
1 Get-MailContact lorem.ipsum@contoso.com | Format-List Id This will give the unique identifier for the mail contact.
Step 2: Verify the Object in Graph API Better safe than sorry- let’s do a double check. Replace &lt;ID> with the ID from Step 1:
...</p></div><footer class=entry-footer><span title='2026-01-26 00:00:00 +0000 UTC'>January 26, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>177 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Force Removal Orphaned Contact in Microsoft 365" href=http://localhost:58330/posts/mail_contact_delete/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>How to Get Rid of Power Apps Permissions Consent Form</h2></header><div class=entry-content><p>Permissions Consent Pop-up Every new user must approve permissions when accessing an app. Existing users see this prompt again after app logic or connector updates.
App permissions consent pop-up
In most scenarios, this pop-up can be bypassed.
Hiding consent pop-up This requries a single PowerShell command:
1 Set-AdminPowerAppApisToBypassConsent -EnvironmentName [Guid] -AppName [Guid] Expected result: BypassConsent flag is set
We can get guids using PowerShell:
...</p></div><footer class=entry-footer><span title='2026-01-11 00:00:00 +0000 UTC'>January 11, 2026</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>356 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to How to Get Rid of Power Apps Permissions Consent Form" href=http://localhost:58330/posts/power_apps_consent/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Assign Calendar Permissions in Bulk</h2></header><div class=entry-content><p>Just a simple one-liner When you have many room mailboxes, granting someone access to each room calendar one-by-one is painful. This one-liner reads a list of room SMTP addresses from a text file and applies the same permission to each mailbox calendar.
1 2 3 4 5 Get-Content .\rooms.txt | % { Write-Host "Working on $_" -ForegroundColor Cyan Add-MailboxFolderPermission -Identity "$($_.Trim()):\Calendar" -User "przemek@contoso.com" -AccessRights Reviewer } Notes Text file we import via Get-Content contains a room email address per line .Trim is being used to remove blank spaces in TXT file - (’ room@contoso.com’ -> ‘room@contoso.com’) - it’s just a safety feature I like to use In some tenants, the calendar folder name might be localized (for example “Kalendarz” in Poland, “Kalender” in Germany and “Calendier” for France) If permissions are already granted for an user, you need to either remove these and re-add or use Set-MailboxFolderPermissions</p></div><footer class=entry-footer><span title='2026-01-10 00:00:00 +0000 UTC'>January 10, 2026</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>147 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Assign Calendar Permissions in Bulk" href=http://localhost:58330/posts/room_perm_bulk/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Updating Distribution List Extended Attributes with PowerShell</h2></header><div class=entry-content><p>The easy part Creating distribution lists in bulk is quite simple.
Just a CSV file:
1 2 3 4 name,mail Fancy Group,Fancy.Group@example.com Another Fancy Group,Another.Fancy.Group@example.com Not That Fancy Group,Not.That.Fancy.Group@example.com And for-each loop
1 2 3 4 5 6 7 Import-Csv .\groups.csv | ForEach-Object { New-DistributionGroup -Name $_.name -PrimarySmtpAddress $_.mail -OrganizationalUnit 'OU=Groups,DC=wrong,DC=went,DC=something,DC=dev' -Type Security } Result:
Name DisplayName GroupType PrimarySmtpAddress Fancy Group Fancy Group Universal, SecurityEnabled Fancy.Group@example.com Another Fancy Group Another Fancy Group Universal, SecurityEnabled Another.Fancy.Group@example.com Not That Fancy Group Not That Fancy Group Universal, SecurityEnabled Not.That.Fancy.Group@example.com But updating msExchExtensionAttribute is different A below won’t work as there is no such command under Set-DistributionGroup.
...</p></div><footer class=entry-footer><span title='2026-01-02 00:00:00 +0000 UTC'>January 2, 2026</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>440 words</span>&nbsp;·&nbsp;<span>Przemek</span></footer><a class=entry-link aria-label="post link to Updating Distribution List Extended Attributes with PowerShell" href=http://localhost:58330/posts/msatt20/></a></article></main><footer class=footer><span>&copy; 2026 <a href=http://localhost:58330/>SomethingWentWrong.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>